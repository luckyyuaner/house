<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.yuan.house.dao.RoleDao">

    <sql id="allColumns">
        role_id, name, title, description, orders
    </sql>

    <select id="getAllRoles" resultType="com.yuan.house.model.Role">
        SELECT
        <include refid="allColumns"/>
        FROM role
        WHERE status = 0
        ORDER BY role_id ASC
    </select>

    <select id="queryRoleById" resultType="com.yuan.house.model.Role">
        SELECT
        <include refid="allColumns"/>
        FROM role
        WHERE status = 0
        AND role_id = #{id}
        ORDER BY role_id ASC
    </select>

    <select id="queryRoleLikeMsg" resultType="com.yuan.house.model.Role">
        SELECT
        <include refid="allColumns"/>
        FROM role
        WHERE status = 0 AND
        (
        name LIKE CONCAT(CONCAT('%', #{msg}), '%')
        OR type LIKE CONCAT(CONCAT('%', #{msg}), '%')
        OR title LIKE CONCAT(CONCAT('%', #{msg}), '%')
        OR description LIKE CONCAT(CONCAT('%', #{msg}), '%')
        )
        ORDER BY role_id ASC
    </select>

    <insert id="addRole" parameterType="com.yuan.house.model.Role">
        <selectKey resultType="java.lang.Long" order="AFTER" keyProperty="roleId">
            SELECT LAST_INSERT_ID()
        </selectKey>
        INSERT INTO role
        (name, title, description, orders, status)
        VALUES
        (#{object.name}, #{object.title}, #{object.description},
        #{object.orders}, #{object.status})
    </insert>

    <update id="updateRole" parameterType="com.yuan.house.model.Role">
        UPDATE role
        SET name = #{object.name}, title = #{object.title}, description = #{object.description},
        orders = #{object.orders}, status = #{object.status}
        WHERE role_id = #{object.roleId}
    </update>

    <delete id="deleteRole" parameterType="Long">
        DELETE FROM role WHERE role_id = #{id}
    </delete>
</mapper>
